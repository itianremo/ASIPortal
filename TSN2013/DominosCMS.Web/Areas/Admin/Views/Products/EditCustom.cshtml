@model DominosCMS.Models.CustomProduct

@{
    ViewBag.Title = "EditCustom";
    var types = ViewBag.Types as IList<string>;
    var products = ViewBag.Products as SelectList;
}

@section scripts {
    @Html.Script("jquery.validate.min.js")
    @Html.Script("jquery.validate.unobtrusive.min.js")
    @Html.Css("themes/base/jquery.ui.all.css")

    <script type="text/javascript">

        $(function () {

            $(".datepicker input").datepicker({
                showOn: "button",
                buttonImage: "/_static/images/icons/calendar.gif",
                buttonImageOnly: true
            });

            $("#Type").change(function () {
                //show spinner after me

                //load the products by selected type

                $.get("@Url.Action("GetJsonProducts")", { type: $(this).val()}, function (data) {
                    if (data)
                    {
                        $("#pLine").empty();
                        $("#pLine").append("<option value=''>Select Product</option>");

                        $.each(data["Result"], function (i, val) {
                            $('#pLine').append('<option value="' + val.ID + '">' + val.Name + '</option>');
                        });
                    }
                    
                }, "json");
            });

        });

    </script>
    <style type="text/css">

        .datepicker input
        {
            width: auto;
        }
    </style>

}


@section actions {
    
    <div class="actions-toolbar">
        <ul>
            <li>
                <a href="@Url.Action("Custom")" title="Back to products">
                    Back to products
                </a>
            </li>
        </ul>
    </div>
    <div class="actions-title">
        <h2>Edit Custom Product</h2>
    </div>
        
}



@using (Html.BeginForm("EditCustom", "Products", FormMethod.Post, new { enctype = "multipart/form-data" })) {
    @Html.ValidationSummary(false)
    <fieldset>
        <legend>CustomProduct</legend>

        @Html.HiddenFor(model => model.ID)

        <div class="editor-label">
            @Html.LabelFor(model => model.Type) <span class="spinner" style="display: none;"></span>
        </div>
        <div class="editor-field">
            @Html.DropDownListFor(model => model.Type, new SelectList(types)) 
            @Html.ValidationMessageFor(model => model.Type)
        </div>
        <div class="editor-label">
            @Html.LabelFor(model => model.ProductLine)
        </div>
        <div class="editor-field">
            @Html.DropDownList("pLine", products, "Select Product")
            @Html.ValidationMessageFor(model => model.ProductLine)
        </div>

        <div class="editor-label">
            Product
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Title)
            @Html.ValidationMessageFor(model => model.Title)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Expires)
        </div>
        <div class="editor-field ">
            <span class="datepicker">
            @Html.EditorFor(model => model.Expires) </span>
            <label><input type="checkbox" name="notExpired" value="true"> Never</label>
            
            @Html.ValidationMessageFor(model => model.Expires)
        </div>

        <div class="editor-label">
            Tech Sheet
        </div>
        <div class="editor-field">
            <input type="file" name="file1" id="file1" /><br /><br />
            @Html.DisplayFor(model => model.Filename)
            @Html.HiddenFor(model => model.Filename)
        </div>
        <div class="editor-label">
            Drawing
        </div>
        <div class="editor-field">
            <input type="file" name="file2" id="file2" /><br /><br />
            @Html.DisplayFor(model => model.DrawingFile)
            @Html.HiddenFor(model => model.DrawingFile)

        </div>


            @Html.HiddenFor(model => model.AssignedTo)

        <p>
            <input type="submit" value="Save" />
        </p>
    </fieldset>
}

<div>
    @Html.ActionLink("Back to List", "Index")
</div>
