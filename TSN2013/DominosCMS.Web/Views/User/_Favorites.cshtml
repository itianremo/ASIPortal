@model IList<DominosCMS.Models.Favorite>
@{
    ViewBag.Title = "_Favorites";
}

<script type="text/javascript">
    $(function () {
        $("#favoritesWrapper").on("click", "a.sortLink", function (e) {
            e.preventDefault();
            var url = $(this).attr("data-source");
            var order = $(this).attr("data-orderby");
            //$("#current-sort").val(order);
            var rndm = Math.floor((Math.random() * 10000) + 1);
            $.get(url, { orderby: order, r: rndm }, function (data) {
                $("#favorites").replaceWith(data);

            });

        });

        $("a.define-section").click(function (e) {
            e.preventDefault();

            var url = $(this).attr("href");
            var dialog = "<div title='Define Favorite Item...' id='definSectionDialog'>";

            $(dialog).append($("<iframe  />").attr({
                "src": url,
                "width": '100%',
                "height": '100%',
                "style": "border: none"
            })).dialog({
                width: 1150,
                height: 550,
                resizable: false,
                buttons: {
                    Close: function () { $(this).dialog("close"); }
                }
            });

        });

    });
</script>

    @if (Model.Count == 0) { 
        <p style="text-align: center">Your don't have any items in your favorites</p>
    } 
else {
<table class="list tablesorter"  align="center" id="favorites">
    <thead>
        <tr>
            <th>
               Type
            </th>
            <th>
                Product
            </th>
            <th class="{sorter: false}">
                Downloads                
            </th>
            <th class="{sorter: false}">
                
            </th>
        </tr>
    </thead>
    <tbody>
    @foreach (var item in Model)
    { 
        <tr>
            <td>
                @Util.GetProductType(item.Product.Type)
            </td>
            <td>
                @Html.ActionLink(item.Product.Title, "Index", "ProductsViewer", new { id = item.Product.URL}, null) 
                @if (item.Product.Type != null && item.Product.Type.Equals("m"))
                {
                    if (item.Section == null)
                    {
                        <br /><span style="font-size: 10px;">(@Html.ActionLink("Define Product", "DefineProduct", "Submittals", new { productID = item.Product.ID, submittalItem = 0, faveID = item.ID, type="fav" }, new { @class = "define-section"}))</span>
                    } else {
                        <br />@Util.FormatSectionTitle(item) 
                    }
                } 
            </td>
            <td class="nowrap">

            @Html.Partial("_downloads", item.Product.Files)

            </td>
            <td class="nowrap">
                @Html.ActionLink("Remove", "DeleteFav", new { id = item.ID }, new { @class = "delete-link" }) | 
                @Html.ActionLink("Add To Queue", "AddToQueue", new { id = item.ID, type = item.Product.Type })
            </td>
        </tr>
    }
        </tbody>
</table>
    }